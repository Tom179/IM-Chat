FROM alpine:3.18.4
ARG SERVER_NAME=user
ARG SERVER_TYPE=rpc

ENV RUN_BIN bin/${SERVER_NAME}-${SERVER_TYPE}
ENV RUN_CONF /${SERVER_NAME}/conf/${SERVER_NAME}.yaml

RUN mkdir -p /$SERVER_NAME/bin && mkdir /$SERVER_NAME/conf
COPY ./bin/$SERVER_NAME-$SERVER_TYPE /$SERVER_NAME/bin/
COPY ./apps/$SERVER_NAME/$SERVER_TYPE/etc/$SERVER_NAME.yaml /$SERVER_NAME/conf/
RUN chmod +X /$SERVER_NAME/bin/$SERVER_NAME-$SERVER_TYPE #执行权限
WORKDIR /$SERVER_NAME

ENTRYPOINT $RUN_BIN -f $RUN_CONF